!function(a,b){"undefined"!=typeof module&&module.exports?"undefined"==typeof angular?module.exports=b(require("angular")):module.exports=b(angular):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a){var b=a.module("tdGal",[]);b.directive("tdGalBackface",["$controller",function(){return{restrict:"E",templateUrl:function(a,b){return b.templateUrl}}}]),b.directive("tdGal",["$controller","$compile","$rootScope",function(a,b,c){return{restrict:"E",replace:!1,scope:{data:"=",onFocus:"&?",onClick:"&?",onInit:"&?",index:"="},link:function(a,d,e,f){var g=a.onFocus?a.onFocus():null,h=a.onClick?a.onClick():null,i=a.onInit?a.onInit():null,j=e.templateUrl;a.localIndex=a.index;var k={heightRatio:a.$eval(e.heightRatio),classes:e["class"],backTemplate:function(c){if(!j)return"";var d=document.createElement("td-gal-backface");d.setAttribute("template-url",j);var e=a.$new();return e.data=c,b(d)(e),d},onClick:function(a){h&&h(a)},onFocus:function(b,d){a.index=a.localIndex=d,g&&g(b),a.$$phase||c.$$phase||a.$apply()},onInit:function(){i&&i(),a.index&&d.tdGal("focus",a.index)}};(!k.heightRatio||k.heightRatio<=0)&&delete k.heightRatio,(!k.classes||k.classes<=0)&&delete k.classes,d.tdGal(k);var l=a.$watch("index",function(b){a.localIndex!=b&&d.tdGal("focus",b)}),m=a.$watch("data",function(a){d.tdGal("elements",a)});a.$on("$destroy",function(){d.tdGal("destroy"),m(),l()})}}}])});